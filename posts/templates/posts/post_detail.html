<div class="post" data-post-id="{{ post.id }}">
    <div class="post-content">
        <div class="vote-section">
            {% if user.is_authenticated %}
            <button class="vote-btn upvote-btn" data-vote-type="upvote" aria-label="Проголосовать за">
                ▲
            </button>
            {% endif %}
            <div class="vote-count" id="post-score">{{ post.score }}</div>
            {% if user.is_authenticated %}
            <button class="vote-btn downvote-btn" data-vote-type="downvote" aria-label="Проголосовать против">
                ▼
            </button>
            {% endif %}
        </div>
<!-- Блок комментариев -->
<div class="card mt-4">
    <div class="card-body">
        <h5>Комментарии ({{ post.comments.count }})</h5>
        
        {% if user.is_authenticated %}
        <form method="post" action="{% url 'comments:add_comment' post.id %}" class="mb-4">
            {% csrf_token %}
            <div class="mb-3">
                <textarea name="content" class="form-control" placeholder="Добавить комментарий..." rows="3" required></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Комментировать</button>
        </form>
        {% endif %}
        
        {% for comment in post.comments.all %}
        <div class="card mb-2">
            <div class="card-body py-2">
                <div class="d-flex justify-content-between">
                    <strong>{{ comment.author.username }}</strong>
                    <small class="text-muted">{{ comment.created_at|timesince }} назад</small>
                </div>
                <p class="mb-1">{{ comment.content }}</p>
                {% if user == comment.author %}
                <form method="post" action="{% url 'comments:delete_comment' comment.id %}" class="d-inline">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-sm btn-danger">Удалить</button>
                </form>
                {% endif %}
            </div>
        </div>
        {% empty %}
        <p class="text-muted">Пока нет комментариев</p>
        {% endfor %}
    </div>
</div>